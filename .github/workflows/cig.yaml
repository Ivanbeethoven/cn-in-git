name: Run CIG in Docker Container

on:
  workflow_dispatch: # 手动触发
  push: # 或自动触发（例如每次 push 时）
    branches: [ "master" ]

jobs:
  run-cig:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      with:
        fetch-depth: 0 # 拉取完整提交历史（如果 cig 需要）

    - name: Pull Docker image
      run: docker pull ghcr.io/ivanbeethoven/cn-in-git:master

    - name: Run CIG command with code mount
      run: |
        docker run \
          -v "${{ github.workspace }}:/workspace" \
          -w /workspace \
          --rm \
          ghcr.io/ivanbeethoven/cn-in-git:master \
          cig
